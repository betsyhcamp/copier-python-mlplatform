version: '3'

tasks:
  install:
    desc: Install dependencies
    cmds:
      - uv sync

  lint:
    desc: Run ruff linter
    cmds:
      - uv run ruff check .

  lint-fix:
    desc: Run ruff linter with auto-fix
    cmds:
      - uv run ruff check --fix .

  format:
    desc: Run ruff formatter
    cmds:
      - uv run ruff format .

  test:
    desc: Run pytest
    cmds:
      - uv run pytest

  ci:
    desc: Run install, lint, and test
    cmds:
      - task: install
      - task: lint
      - task: test

  all-precommit:
    desc: Run all pre-commit hooks
    cmds:
      - uv run pre-commit run --all-files
{% if project_type in ['package', 'pipeline-kfp'] %}
  docs:
    desc: Build HTML documentation locally
    cmds:
      - uv run sphinx-build -b html docs docs/_build/html

  docs-clean:
    desc: Remove built documentation
    cmds:
      - rm -rf docs/_build
{% endif %}
{% if project_type == 'pipeline-kfp' %}
  compile:
    desc: Compile pipeline to JSON
    cmds:
      - echo "Not implemented"

  run-local:
    desc: Run pipeline components locally
    cmds:
      - echo "Not implemented"
{% endif %}
